---
title: "リポジトリ"
free: true
---

本章ではプロジェクトで作成される様々な資料やプログラム資産を保存・バージョン管理するために使用されるリポジトリについて解説します。

## リポジトリ(バージョン管理システム)とは

リポジトリとはファイルの置き場所及び管理システムのことです。  
他にファイル管理で代表的なものにOSのファイルシステム（Windowsではエクスプローラ）があります。
ファイルシステムとリポジトリの大きな違いは、リポジトリには**履歴を管理する機能**があるということです。

履歴を管理する機能とは、ファイルの過去の状態を遡って参照できる事を指します。  
この事から**バージョン管理システム**とも呼ばれています。

厳密にはバージョン管理システムによって管理されている領域をリポジトリと呼びますが、同じ様な意味合いで使われる事が多いです。

リポジトリには上記で挙げた機能以外にも以下の機能を備えています。

- ファイルの作成日時、変更日時、変更点などの履歴を保管することができる。
- 過去の状態や変更内容を確認したり、変更前の状態を復元することができる。
- メタ情報（変更コメントなど）を管理することができる。
- 複数人で同一ファイルを修正した場合に、競合を解決する事ができる。

:::message
一般的なファイルサーバでは複数の人が複数のファイルを各々編集するとそれぞれのファイルの最新の状態が分からなくなったり、同一ファイルに対する変更が競合するなどの問題が生じやすくなります。
多くのバージョン管理システムでは複数の人がファイルの編集に関わる状況を想定しておりこのような問題を解決する仕組みを提供します。
:::

## バージョン管理システムの方式

バージョン管理システムには方式として「集中型」と「分散型」の二種類に分類されます。

### 集中型（有名なソフト名：Subversion(SVN)、CVS）

![](/images/books/497459787cb294/svn.png)

分散型よりも前に存在し、長きに渡りバージョン管理システムのスタンダードとして利用されてきた方式。

概ね以下の特徴があります。

- 共有サーバにメンバーと共有するためのリポジトリ（中央リポジトリ）を作成し、そのリポジトリでバージョン管理を行う。

- 利用者は**チェックアウト**を行い、リポジトリの内容をローカルPCにコピーする。

- 利用者はコピーの編集内容を中央リポジトリに対して**コミット**する。

- コミットが行われるとその変更を他のプログラマが確認・取得（更新）できるようになる。

- このバージョン管理機能を利用するにはリポジトリにアクセスが必要であり、**ソースコードの変更管理にはネットワーク接続が必要となる。**

### 分散型（有名なソフト名：Git）

![](/images/books/497459787cb294/git.png)

数年前より集中型よりもメリットが大きいとされ、徐々にシェアを増やしつつある方式。

概ね以下の特徴があります。

- 共有サーバにメンバーと共有するための【リモート】リポジトリを作成する。ただし1つとは限らない。

- 各プログラマのPCそれぞれに【ローカル】リポジトリを作成して、**プル**で【リモート】リポジトリの内容をコピーし、その後で各々バージョン管理を行う。

- 利用者は【ローカル】リポジトリに対し変更したファイルを**コミット**する。

- 【ローカル】リポジトリで行われた変更作業は**プッシュ**で【リモート】リポジトリに反映することができる。

- ソースコードの変更管理には**ネットワークに随時接続しておく必要が無く、**【リモート】リポジトリに変更の移動や取得を行う際にネットワークに繋がっていればよい。（コミット時点ではローカルPC内で完結しているため）

- サーバー間ではフォークとプルリクエスト（GitLabではマージリクエストという）でリポジトリの同期を行う。

### 集中型 VS 分散型

現在のバージョン管理システムは集中型から分散型へ移行中の過渡期とも言える状況です。
古くからプロジェクトで使われている集中型のバージョン管理方法をいきなり変更する事は簡単ではないので、新規プロジェクトは分散型で従来プロジェクトは集中型という事がしばしばあります。

ただし、分散型は集中型の上位互換かというと必ずしもそうとは言えないため、集中型が無くなるという事もおそらくありません。
が、ほとんどのプロジェクトは分散型の利点が優っているため徐々に分散型が広まっているわけです。

集中型が分散型より優れている点は正直とても局所的で説明が困難です。
ですので、分散型が集中型より優れている点のみおさらいします。

#### バージョン管理（コミット）する際にネットワーク接続の必要が無い。

バージョン管理は各々のPC内の【ローカル】リポジトリで行うため、最終的に【リモート】リポジトリにプッシュするまではネットワーク接続の必要がありません。

#### 【リモート】リポジトリにコミット権限が無くても修正案を提供できる。

集中型の場合は【リモート】リポジトリに相当する中央リポジトリにコミット権限が無いとプログラム修正内容を確認してもらう事ができません。
分散型の場合はフォークという方法で【リモート】リポジトリをコピーした後、そのコピーにプログラム修正を行う事で、修正内容を確認してもらう事ができる様になります。

#### より強力なマージ機能がある。

フォークしたリポジトリの変更内容や、【リモート】リポジトリと【ローカル】リポジトリの変更点を視覚的に確認しやすくする機能やマージ（変更した部分を写す）を自動化してくれる機能があります。

:::message
最近は集中型のマージ機能も優秀になっていますので差は縮まっています。
それでも、後ほど説明するGitHubやGitLabのようなGUIを備えた無料で使えるサービスがSVNには不足していると感じます。
:::

#### コミット履歴の整理ができる。

集中型は中央リポジトリに直接コミットするため、コミット履歴が全て残ります。（間違った修正をコミットした後すぐに正しいコミットを行っても履歴が残ってしまいます）
分散型は間違ったコミットは無かった事にする事ができます。なぜなら一度【ローカル】リポジトリにコミットしてから【リモート】リポジトリにプッシュしますが、【ローカル】リポジトリは自身のPCのみで管理されている領域なので好きな様に改変しても他の利用者に影響が無いためです。

:::message alert
分散型であってもすでに【リモート】リポジトリにプッシュした後は、他の利用者への影響があるため履歴の改変は大変危険な行為です。
:::

以上の事からこの入門書では分散型バージョン管理システムの **Git（ギット）** を使用していきます。

## リポジトリホスティングサービス

集中型バージョン管理システムでは、中央リポジトリが置かれているサーバがシステムの主体（ホスト）となりますが、分散型の場合はリポジトリが複数ある（分散している）ので、それらリポジトリを纏めて管理する**リポジトリホスティングサービス**が必要となります。

実は、今までリポジトリ（リモート）と呼ばれていたものは、リポジトリホスティングサービスによって管理されているリポジトリの事を指しています。

リポジトリホスティングサービスはいくつか有名なものがあります。
現在最も有名な **GitHub(ギットハブ)** やGitHubをクローン（模倣）したオープンソースの **GitLab(ギットラボ)** などです。

本書ではGitLabを使用します。
